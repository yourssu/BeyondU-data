### 엑셀 to 데이터베이스 ETL 프로세스 요약

*   **프로젝트 목표:** 여러 형태의 엑셀 파일에 담긴 대학 교환학생 프로그램 데이터를 분석하여 정제된 형태로 데이터베이스(SQLite)에 저장하는 파이썬 ETL 파이프라인입니다.

*   **실행 시작점:**
    *   `scripts/run_etl.py`: 전체 ETL 프로세스를 시작하고 제어하는 메인 스크립트입니다. 커맨드 라인 인자를 통해 특정 파일이나 폴더를 처리하고, 데이터베이스 초기화 등의 작업을 수행합니다.

*   **1. 데이터 추출 (Extract):**
    *   **담당 모듈:** `src/extract/excel_reader.py`
    *   엑셀 파일(`.xlsx`, `.xls`)을 읽어들입니다.
    *   통합된 셀(Merged Cells)을 자동으로 인식하고 값을 채워 넣어 데이터 유실을 방지합니다.
    *   `대학명`, `국가명` 같은 키워드를 기반으로 헤더(Header) 위치를 동적으로 찾아냅니다.
    *   '대학명(국문)' -> 'name_kr' 와 같이 한글 컬럼명을 미리 정의된 영문명으로 표준화합니다.
    *   파일명 자체에서 `2024-1` (학기), `1차` (모집 차수) 같은 메타데이터를 추출합니다.

*   **2. 데이터 변환 (Transform):**
    *   **담당 모듈:** `src/transform/cleaner.py`, `src/transform/parser.py`
    *   **`cleaner.py`**: 기본적인 데이터 정제를 수행합니다. (불필요한 공백 제거, 요약/합계 행 제거 등)
    *   **`parser.py`**: 가장 복잡하고 핵심적인 변환을 담당합니다.
        *   **`LanguageParser`**: "A2", "TOEFL 80점", "IELTS 6.5 이상 (토익 제외)" 와 같이 비정형적인 텍스트로 된 어학 요건을 구조화된 데이터로 파싱합니다.
        *   예를 들어, 'A2'라는 내부 코드를 TOEFL, IELTS, TOEIC 점수로 자동 변환하여 각각 별도의 데이터 행으로 만듭니다.
        *   '3.0/4.5' 와 같은 학점(GPA) 요구사항도 일관된 형식으로 정규화합니다.

*   **3. 데이터 적재 (Load):**
    *   **담당 모듈:** `src/load/models.py`, `src/load/database.py`
    *   **`models.py`**: SQLAlchemy를 사용하여 데이터베이스 테이블(`University`, `LanguageScore`)의 구조를 정의합니다. `University`와 `LanguageScore`는 1:N 관계입니다. (한 대학은 여러 어학 요건을 가질 수 있음)
    *   **`database.py`**: 실제 데이터베이스 작업을 수행합니다.
        *   엑셀의 '일련번호'를 기준으로 `University` 테이블에 데이터를 **Upsert** (Update or Insert) 합니다. 즉, 기존에 데이터가 있으면 업데이트하고, 없으면 새로 추가합니다.
        *   대학 정보가 저장된 후, 파싱된 어학 요건 데이터를 `LanguageScore` 테이블에 저장합니다. 이때 기존 어학 요건은 삭제하고 새로 파싱된 데이터를 저장하여 항상 최신 상태를 유지합니다.
